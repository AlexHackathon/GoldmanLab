---
title: Lab Assignment 2
author: STA 100 | A Farris | Winter 2024
abstract: \emph{A pdf copy of your assignment is due at 5pm on Wednesday, January 31. Submission of the pdf will be through Gradescope. Please put in the effort to make it look reasonably professional -- you're encouraged to use R Markdown. Note that specific tasks for you are \hl{highlighted}.}
header-includes:
   - \usepackage{enumerate,verbatim,graphicx,soul}
   - \renewcommand{\abstractname}{}
geometry: margin=0.75in
output: pdf_document
---

\subsection*{Introduction to the Evans data}
In this assignment, we will investigate the results of an epidemiological cohort study in which 609 subjects were followed for 7 years, with coronary heart disease as the outcome of interest. This is an opportunity for us to explore the use of some summary statistics, and to illustrate useful computational tools like subsetting. We begin by obtaining the data:

```{r}
vars <- c("ID","CHD","CAT","AGE","CHL","SMK","ECG","DBP","SBP","HPT","CH","CC")
evans <- read.table("http://www.stat.ucdavis.edu/~affarris/evans.dat",
                    header=FALSE,
                    col.names=vars)
```

This data contains much information about the subjects:

| Variable | Description |
| -------- | ----------- |
|ID | Subject ID, one observation per subject |
|CHD | Coronary heart disease (1) or not (0)|
|CAT | High catecholamine level (1) or not (0)|
|AGE | Age in years|
|CHL | Cholesterol level|
|SMK | Ever smoked (1) or never smoked (0)|
|ECG | ECG abnormality (1) or not (0)|
|DBP | Diastolic blood pressure|
|SBP | Systolic blood pressure|
|HPT | = 1 if DBP $\ge 90$ or SBP $\ge 160$, otherwise = 0|
|CH | CAT*HPT|
|CC | CAT*CHL|

We can see what the first six subjects look like using the \verb+head+ function:
```{r,comment=NA}
head(evans)
```

It is also possible to exctract specific columns in this data by using \verb+$+:
```{r,comment=NA}
head(evans$AGE)
```

We can easily obtain simple summary statistics, for example using \verb+mean+ and \verb+sd+:
```{r,comment=NA}
mean(evans$AGE)
sd(evans$AGE)
```
We can get the minimum, maximum, and first three quartiles (along with the mean) using \verb+summary+:
```{r,comment=NA}
summary(evans$AGE)
```

It is tempting to think, because the mean is greater than the median, that the distribution of ages in this study might be right skewed. We can check this using a histogram :
```{r,comment=NA}
hist(evans$AGE,
     col="lightgreen")
```


Let's investigate the relationship between coronary heart disease and catecholamine level in the subjects. Because both are recorded as categorical data, we can use a table with the frequency distribution (contingency table): 
```{r,comment=NA}
CatChdTable <- table("High catecholamine level (CAT)"=evans$CAT,
                 "Coronary heart disease (CHD)"=evans$CHD)
CatChdTable
```

We can graphically depict a contingency table using a \emph{mosaic pot}, in which the areas of rectangles are used to represent the frequencies arrayed in the table: 


```{r}
mosaicplot(CatChdTable,
           main="Mosaic plot of CAT vs. CHD",
           col = "lightblue")
```

From these we can see that a disproportionate number of the subjects with high catecholamine levels also had coronary heart disease.

Let's investigate further. If we factor in cholesterol levels as well, what can we say? Since cholesterol is a quantitative variable, while CAT and CHD are both categorical (grouping) variables, we could use aligned boxplots:

```{r}
boxplot(CHL~CHD+CAT,
        data=evans,
        xlab="CHD.CAT",
        col="lightpink")
```

We can compare the cholesterol level distributions for these groups in terms of center, spread, and shape, in decreasing order of importance. The groups with CHD=0 and CAT=0, and with CHD=1 and CAT=0 (respectively marked as 0.0 and 1.0) appear not to differ much in terms of center. Those with CHD=0 and CAT=1 have relatively lower center, though, and those with CHD=1 and CAT=1 have higher center. Furthermore, the group with CHD=0 and CAT=0 seem to have higher spread among their cholesterol levels, while the other three groups' spreads seem similar. We can further quantify these using means
```{r,comment=NA}
aggregate(CHL~CHD+CAT,
          data=evans,
          mean)
```
and (sample) standard deviations
```{r,comment=NA}
aggregate(CHL~CHD+CAT,
          data=evans,
          sd)
```
. Notice that the standard deviations show more variation between spreads in the latter three groups than is apparent in the boxplots. The standard deviations for the  CHD=0 and CAT=0 and  CHD=1 and CAT=0 groups are closer than the spreads appear in the boxplots, which may be due to the presence of a single, very extreme value in the latter group that is visible in the boxplot (remember that SDs, like means, are attracted to extreme values).

If we need to, we can look at the shapes of the distributions for each group using histograms. For example, for the group with CHD=0 and CAT=0, we see a distribution that is roughly bell shaped, with a slight skew in the direction of higher cholesterol levels:

```{r}
hist(evans$CHL[evans$CHD==0 & evans$CAT==0], 
     xlab = "CHL", 
     ylab = "Frequency", 
     main = "Histogram of CHL when CHD=0 and CAT=0",
     col="lightblue")
```



The differences in centers of the distributions of cholesterol between these groups is the most clearly interpretable result here, with which we can summarize the relationship between catecholamine level, cholesterol levels, and coronary heart disease. We can interpret these differences to tell us that subjects with low catecholamine levels have similar average levels of cholesterol whether they have coronary heart disease or not. However, subjects with high catecholamine levels have seemingly higher levels of cholesterol on average when they have coronary heart disease than when they do not.

\subsection*{Assignment}

\hl{Using a contingency table, investigate the relationship between coronary heart disease and smoking in this sample.}

\hl{Also, investigate the relationship between coronary heart disease, smoking, and age. How do the distributions of age differ between the four groups obtained by heart disease and smoking status? Use aligned boxplots, means, standard deviations, and if necessary, histograms to compare these. What do these tell you about the relationship between smoking and coronary heart disease?}

First, we display a table showing the absolute frequency of the four groups created by looking at coronary heart disease and smoking
```{r}
CHDxSMKtbl <- table("Coronary Heart Disease" = evans$CHD, "Smoking" = evans$SMK)
CHDxSMKtbl
```

Next, a mosaic plot can show if an unusual number of people with one trait also contained the other
```{r}
mosaicplot(CHDxSMKtbl,
           main = "Coronary Heart Disease and Smoking",
           col = "lightblue")
```

The proportion of people who hadn't smoked and have coronary heart disease out of the people who hadn't smoked is lower than the proportion of people who had smoked and had coronary heart disease out of all the people who had smoked.

To look at how age relates to coronary heart disease and smoking, we can look at side by side boxplots for the four groups.
```{r}
boxplot(AGE~CHD+SMK,
        data=evans,
        xlab="CHD.SMK",
        col="purple")
```

In the boxplots, the first number represents whether the group has coronary heart disease while the second indicates that they smoke.

0.0: People who didn't have coronary heart disease and didn't smoke.

1.0: People who had coronary heart disease and didn't smoke.

0.1: People who didn't have coronary heart disease but did smoke.

1.1: People who have coronary heart disease and smoke

The boxplots for the four groups vary in both center and spread. The median age is highest for group 1.0, followed by approximately equal medians for groups 0.0 and 1.1, and then by the median of group 0.1. The range for the four groups is almost identical, although group 1.0 has a slightly lower range. The IQR for groups 1.0 and 0.1 are similar while the IQR for groups 0.0 and 1.1 are larger and also approximately equal.

We can also look at center by looking at the mean.

```{r}
aggregate(AGE~CHD+SMK,
          data=evans,
          mean)
```

And the spread by looking at standard deviation.

```{r}
aggregate(AGE~CHD+SMK,
          data=evans,
          sd)
```

The center when looking at the mean of the data shows the same relationship as when looking at the median. The standard deviation shows similar relationships of spread as IQR. Groups 1.0 and 0.1 have similar spread, while groups 0.0 and 1.0 also have similar spreads that are larger than the previous two groups.

\hrulefill
\clearpage

\subsection*{Appendix: R Script}

```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE}
```

